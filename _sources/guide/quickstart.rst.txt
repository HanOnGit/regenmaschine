Quickstart
==========

Regenmaschine aims to be easy in both setup and usage. Here's how to get started.

Authentication
--------------

Authentication is the first step and can be done against the local device or the
cloud API:

.. code-block:: python

  import regenmaschine as rm

  # Authenticate against the local device or the remote API:

  auth = rm.Authenticator.create_local('192.168.1.100', 'MY_RM_PASSWORD')
  auth = rm.Authenticator.create_remote('EMAIL_ADDRESS', 'MY_RM_PASSWORD')

This Authenticator object can then be used to instantiate a Regenmaschine client:

.. code-block:: python

  client = rm.Client(auth)

It's important to note that once instantiated, the client only knows about the
device/service against which it was authenticated. Put simply, if you create a
"local client" and later want a "remote client," you'll need to re-authenticate
and re-create the client.

Programs
--------

RainMachine™ programs are collections of zone actions grouped together. For
complete information on the response formats for program operations, check out
the official RainMachine™ API docs:
`<http://docs.rainmachine.apiary.io/#reference/programs>`_

In terms of retrieving program information, Regenmaschine offers several
methods. To retrieve information on all programs:

.. code-block:: python

  client.programs.all()
  # >>> {u'programs': [{u'startDate': u'2017-07-01',}] ... }

To retrieve information on a specific program (in this case, program #6):

.. code-block:: python

  client.programs.get(6)
  # >>> {u'status': 0, u'ignoreInternetWeather': False, ... }

To retrieve the next run date/time for all programs:

.. code-block:: python

  client.programs.next()
  # >>> {u'nextRuns': [{u'pid': 3, u'startTime': u'06:00'}, ] ... }

To retrieve all running programs:

.. code-block:: python

  client.programs.running()
  # >>> {u'programs': [{u'startDate': u'2017-07-01',}] ... }

Regenmaschine also offers two methods to spur programs into (in)action. To
start program #7:

.. code-block:: python

  client.programs.start(7)
  # >>> {u'message': u'OK', u'statusCode': 0}

...and to stop it:

.. code-block:: python

  client.programs.stop(7)
  # >>> {u'message': u'OK', u'statusCode': 0}

Zones
-----

RainMachine™ zones are physical locations where watering occurs. For
complete information on the response formats for zone operations, check out
the official RainMachine™ API docs:
`<http://docs.rainmachine.apiary.io/#reference/zones>`_

As with programs, Regenmaschine offers several retrieval methods for zone
information. To retrieve information on all zones:

.. code-block:: python

  client.zones.all()
  # >>> { "zones": [ { "uid": 1, "name": "Backyard Landscaping",}] ... }

To retrieve even more detailed information about all zones, simply set the
:code:`properties` parameter to :code:`True`:
.. code-block:: python

  client.zones.all(properties=True)
  # >>> { "zones": [ { "uid": 1, "name": "Backyard Landscaping", ] ... }

To retrieve information about a specific Zzone (in this case, zone #2):

.. code-block:: python

  client.zones.get(2)
  # >>> { "uid": 1, "name": "Backyard Landscaping", "state": 0, ... }

Once again, detailed information about a zone can be retrieved by setting the
:code:`properties` parameter to :code:`True`:

.. code-block:: python

  client.zones.get(2, properties=True)
  # >>> { "uid": 1, "name": "Backyard Landscaping", "valveid": 1, ... }

As with programs, zones can also be started and stopped from Regenmaschine. To
start zone 3 for 60 seconds:

.. code-block:: python

  client.zones.start(3, 60)

...and to stop it:

.. code-block:: python

  client.zones.stop(3)

Regenmaschine also can return a "simulated run" for zones, which provivdes an
understanding of what a specific zone will do when run next. To do this:

.. code-block:: python

  # Get the complete properties of the zone we want to simulate:
  properties = client.zones.get(2, properties=True)

  client.zones.simulate(properties)
  # >>> { "referenceTime": 1243, "currentFieldCapacity": 30.92 }

